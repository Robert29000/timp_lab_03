language: cpp
os:
- linux
- osx
compiler:
- gcc
- clang
addons:
  apt:
    sources:
    - ubuntu-toolchain-r-test
    - llvm-toolchain-precise-3.7
    packages:
    - cmake
    - cmake-data
    - clang-3.7
    - g++-7
    - rpm
script:
- cd hello_world_application
- cmake -H. -B_build
- cmake --build _build
- cmake --build _build --target hello_world
- "./_build/hello_world"
- echo "Hello world application testing is done"
- cd ..
- cd solver_application
- cmake -H. -B_build
- cmake --build _build
- cmake --build _build --target solver
- echo "Solver application testing is done"
- cmake --build _build --target package_source
- cd _build
- if [ "$TRAVIS_OS_NAME" = "osx" ]; then cpack -G DragNDrop  ;fi
- if [ "$TRAVIS_OS_NAME" = "linux" ]; then cpack -G DEB  ;fi
- if [ "$TRAVIS_OS_NAME" = "linux" ]; then cpack -G RPM  ;fi
deploy:
  provider: releases
  file:
  - solver_application/_build/solver-source-files.zip
  - solver_application/_build/solver-source-files.tar.gz
  - if [ "$TRAVIS_OS_NAME" = "osx" ]; then 'solver_application/_build/solver.dmg'  ;fi
  - if [ "$TRAVIS_OS_NAME" = "linux" ]; then 'solver_application/_build/solver.rpm'  ;fi
  - if [ "$TRAVIS_OS_NAME" = "linux" ]; then 'solver_application/_build/solver.deb'  ;fi
  on:
    tags: true
    repo: Robert29000/timp_lab_03
  cleanup: 'true'
  token:
    secure: f6pOr+3g5Eu+37GBQAyilPHxXeYFeb9hpnyCEMxf5fV9HBN4Oc5TGT94OLiZjHshRE26q3FPDy6WrrRI3MoYP5+9pLpUoO1VAa6hpnUkXLoW68YOwGCoU+mMaxn4klRZkh6NdZFUyxUIgk0DUl68piKyl1itHiGbHY4cdRGE4zX4rKUVymPr9qsLEGYwrYXAtP7FGVBG4w5ilrnhYRM1MwN6fFhv07IusijTkZU9PjQAa1BEslza8tvMn2savo12dbvlhwP3PaxdEqzo2AC0zJ1xlhCuVwbz+8Y/iQPq9hvRAHegrB9nRFUcFpdE+DJC3B5HF9UzoEl2F2Se8oALKJAxsVVYcFpEX0UnFiUnHWRH8pCswM8/Jc3QLoUqbI5bMnjnK4Sjn/FunoDP7NpJqyVoDjoQlHTaFuBGLbomjfVFzA8j5S8Kpp5Fa9kqqAAZ+rtvZs9+x3WB3wKYk4hsZmzlxb1z9FrYxMsvlaQfjbhcpLjjf3XahDpQjKt6Z5SprWgXG93a0DsEBLP46+spBJIIG/T1FS7NBVm6fEYBnncBHAT2G1rs7toxICdhs8xu8y5FIlQV31tkPtVZTiaJg7XFKa3bGSL/0oznfWDn42zEj2JbIpMDiXn1f4ccdtfBZ78j8+4w/PMmQnsUvSdWtkEY6UKCodGPmqkX7nUGK+g=
